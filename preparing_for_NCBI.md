# Preparing data for NCBI

For genome assemblies, NSBI only will take assembled bits that are greater than 200bp.

I got this script off of the internet (removessmall.pl). I think the command line is something like perl ./removessmall.pl 200 fasta.in > fasta_filtered.out

```perl
## removesmalls.pl
#!/usr/bin/perl
use strict;
use warnings;

my $minlen = shift or die "Error: `minlen` parameter not provided\n";
{
    local $/=">";
    while(<>) {
        chomp;
        next unless /\w/;
        s/>$//gs;
        my @chunk = split /\n/;
        my $header = shift @chunk;
        my $seqlen = length join "", @chunk;
        print ">$_" if($seqlen >= $minlen);
    }
    local $/="\n";
}
```

# Labeling mtDNA seqs

I used blast to identify putative mtDNA matches.  THen I extracted the scaffold names and built the sed commands below to swap out the names with an mtDNA label.  The sed commands are separated by semicolons and are being run successively.

`sed -ie 's/>42461639 />42461639_mtDNA /g' AO245_newtrim_scaffolds_gt_200_bp.fa;sed -ie 's/>12136199 />12136199_mtDNA /g' AO245_newtrim_scaffolds_gt_200_bp.fa;sed -ie 's/>42195086 />42195086_mtDNA /g' AO245_newtrim_scaffolds_gt_200_bp.fa;sed -ie 's/>29314923 />29314923_mtDNA /g' AO245_newtrim_scaffolds_gt_200_bp.fa;sed -ie 's/>42635599 />42635599_mtDNA /g' AO245_newtrim_scaffolds_gt_200_bp.fa;sed -ie 's/>42483798 />42483798_mtDNA /g' AO245_newtrim_scaffolds_gt_200_bp.fa;sed -ie 's/>6109061 />6109061_mtDNA /g' AO245_newtrim_scaffolds_gt_200_bp.fa;sed -ie 's/>41822830 />41822830_mtDNA /g' AO245_newtrim_scaffolds_gt_200_bp.fa;sed -ie 's/>21838983 />21838983_mtDNA /g' AO245_newtrim_scaffolds_gt_200_bp.fa;sed -ie 's/>33327486 />33327486_mtDNA /g' AO245_newtrim_scaffolds_gt_200_bp.fa;sed -ie 's/>42357570 />42357570_mtDNA /g' AO245_newtrim_scaffolds_gt_200_bp.fa;sed -ie 's/>42493239 />42493239_mtDNA /g' AO245_newtrim_scaffolds_gt_200_bp.fa;sed -ie 's/>42490063 />42490063_mtDNA /g' AO245_newtrim_scaffolds_gt_200_bp.fa;sed -ie 's/>29317533 />29317533_mtDNA /g' AO245_newtrim_scaffolds_gt_200_bp.fa;sed -ie 's/>9261433 />9261433_mtDNA /g' AO245_newtrim_scaffolds_gt_200_bp.fa;sed -ie 's/>20791471 />20791471_mtDNA /g' AO245_newtrim_scaffolds_gt_200_bp.fa;sed -ie 's/>42685736 />42685736_mtDNA /g' AO245_newtrim_scaffolds_gt_200_bp.fa;sed -ie 's/>42672574 />42672574_mtDNA /g' AO245_newtrim_scaffolds_gt_200_bp.fa;sed -ie 's/>42014226 />42014226_mtDNA /g' AO245_newtrim_scaffolds_gt_200_bp.fa;sed -ie 's/>42687319 />42687319_mtDNA /g' AO245_newtrim_scaffolds_gt_200_bp.fa;sed -ie 's/>42448928 />42448928_mtDNA /g' AO245_newtrim_scaffolds_gt_200_bp.fa;sed -ie 's/>42448928 />42448928_mtDNA /g' AO245_newtrim_scaffolds_gt_200_bp.fa;sed -ie 's/>5011771 />5011771_mtDNA /g' AO245_newtrim_scaffolds_gt_200_bp.fa;sed -ie 's/>18630804 />18630804_mtDNA /g' AO245_newtrim_scaffolds_gt_200_bp.fa;sed -ie 's/>42429409 />42429409_mtDNA /g' AO245_newtrim_scaffolds_gt_200_bp.fa;sed -ie 's/>42149496 />42149496_mtDNA /g' AO245_newtrim_scaffolds_gt_200_bp.fa;sed -ie 's/>11472894 />11472894_mtDNA /g' AO245_newtrim_scaffolds_gt_200_bp.fa;sed -ie 's/>42032110 />42032110_mtDNA /g' AO245_newtrim_scaffolds_gt_200_bp.fa;sed -ie 's/>27832253 />27832253_mtDNA /g' AO245_newtrim_scaffolds_gt_200_bp.fa;sed -ie 's/>10127245 />10127245_mtDNA /g' AO245_newtrim_scaffolds_gt_200_bp.fa;sed -ie 's/>22002642 />22002642_mtDNA /g' AO245_newtrim_scaffolds_gt_200_bp.fa;sed -ie 's/>12451244 />12451244_mtDNA /g' AO245_newtrim_scaffolds_gt_200_bp.fa;sed -ie 's/>42425770 />42425770_mtDNA /g' AO245_newtrim_scaffolds_gt_200_bp.fa;sed -ie 's/>35787938 />35787938_mtDNA /g' AO245_newtrim_scaffolds_gt_200_bp.fa;sed -ie 's/>30658646 />30658646_mtDNA /g' AO245_newtrim_scaffolds_gt_200_bp.fa;sed -ie 's/>14278050 />14278050_mtDNA /g' AO245_newtrim_scaffolds_gt_200_bp.fa;sed -ie 's/>39362983 />39362983_mtDNA /g' AO245_newtrim_scaffolds_gt_200_bp.fa;sed -ie 's/>15909369 />15909369_mtDNA /g' AO245_newtrim_scaffolds_gt_200_bp.fa;sed -ie 's/>36942369 />36942369_mtDNA /g' AO245_newtrim_scaffolds_gt_200_bp.fa;sed -ie 's/>42718961 />42718961_mtDNA /g' AO245_newtrim_scaffolds_gt_200_bp.fa;sed -ie 's/>38129890 />38129890_mtDNA /g' AO245_newtrim_scaffolds_gt_200_bp.fa;sed -ie 's/>4676557 />4676557_mtDNA /g' AO245_newtrim_scaffolds_gt_200_bp.fa;sed -ie 's/>2886943 />2886943_mtDNA /g' AO245_newtrim_scaffolds_gt_200_bp.fa;sed -ie 's/>37688818 />37688818_mtDNA /g' AO245_newtrim_scaffolds_gt_200_bp.fa;sed -ie 's/>6229871 />6229871_mtDNA /g' AO245_newtrim_scaffolds_gt_200_bp.fa;sed -ie 's/>24980626 />24980626_mtDNA /g' AO245_newtrim_scaffolds_gt_200_bp.fa;sed -ie 's/>24980626 />24980626_mtDNA /g' AO245_newtrim_scaffolds_gt_200_bp.fa;sed -ie 's/>38113410 />38113410_mtDNA /g' AO245_newtrim_scaffolds_gt_200_bp.fa;sed -ie 's/>28469890 />28469890_mtDNA /g' AO245_newtrim_scaffolds_gt_200_bp.fa;sed -ie 's/>12499988 />12499988_mtDNA /g' AO245_newtrim_scaffolds_gt_200_bp.fa;sed -ie 's/>6826565 />6826565_mtDNA /g' AO245_newtrim_scaffolds_gt_200_bp.fa;sed -ie 's/>15745554 />15745554_mtDNA /g' AO245_newtrim_scaffolds_gt_200_bp.fa;sed -ie 's/>6062104 />6062104_mtDNA /g' AO245_newtrim_scaffolds_gt_200_bp.fa;sed -ie 's/>30984312 />30984312_mtDNA /g' AO245_newtrim_scaffolds_gt_200_bp.fa;sed -ie 's/>6534320 />6534320_mtDNA /g' AO245_newtrim_scaffolds_gt_200_bp.fa;sed -ie 's/>21722262 />21722262_mtDNA /g' AO245_newtrim_scaffolds_gt_200_bp.fa;sed -ie 's/>21722262 />21722262_mtDNA /g' AO245_newtrim_scaffolds_gt_200_bp.fa;sed -ie 's/>27711703 />27711703_mtDNA /g' AO245_newtrim_scaffolds_gt_200_bp.fa;sed -ie 's/>14233045 />14233045_mtDNA /g' AO245_newtrim_scaffolds_gt_200_bp.fa;sed -ie 's/>31453142 />31453142_mtDNA /g' AO245_newtrim_scaffolds_gt_200_bp.fa;sed -ie 's/>8956765 />8956765_mtDNA /g' AO245_newtrim_scaffolds_gt_200_bp.fa;sed -ie 's/>42577675 />42577675_mtDNA /g' AO245_newtrim_scaffolds_gt_200_bp.fa;sed -ie 's/>2591177 />2591177_mtDNA /g' AO245_newtrim_scaffolds_gt_200_bp.fa;sed -ie 's/>37023915 />37023915_mtDNA /g' AO245_newtrim_scaffolds_gt_200_bp.fa;sed -ie 's/>42575553 />42575553_mtDNA /g' AO245_newtrim_scaffolds_gt_200_bp.fa;sed -ie 's/>16440720 />16440720_mtDNA /g' AO245_newtrim_scaffolds_gt_200_bp.fa;sed -ie 's/>12480884 />12480884_mtDNA /g' AO245_newtrim_scaffolds_gt_200_bp.fa;sed -ie 's/>32093533 />32093533_mtDNA /g' AO245_newtrim_scaffolds_gt_200_bp.fa;sed -ie 's/>17006059 />17006059_mtDNA /g' AO245_newtrim_scaffolds_gt_200_bp.fa;sed -ie 's/>33192715 />33192715_mtDNA /g' AO245_newtrim_scaffolds_gt_200_bp.fa;sed -ie 's/>40272107 />40272107_mtDNA /g' AO245_newtrim_scaffolds_gt_200_bp.fa;sed -ie 's/>17777989 />17777989_mtDNA /g' AO245_newtrim_scaffolds_gt_200_bp.fa;sed -ie 's/>37409881 />37409881_mtDNA /g' AO245_newtrim_scaffolds_gt_200_bp.fa;sed -ie 's/>42624677 />42624677_mtDNA /g' AO245_newtrim_scaffolds_gt_200_bp.fa;sed -ie 's/>31021506 />31021506_mtDNA /g' AO245_newtrim_scaffolds_gt_200_bp.fa;sed -ie 's/>4910452 />4910452_mtDNA /g' AO245_newtrim_scaffolds_gt_200_bp.fa;sed -ie 's/>37352116 />37352116_mtDNA /g' AO245_newtrim_scaffolds_gt_200_bp.fa;sed -ie 's/>11038717 />11038717_mtDNA /g' AO245_newtrim_scaffolds_gt_200_bp.fa;sed -ie 's/>42622422 />42622422_mtDNA /g' AO245_newtrim_scaffolds_gt_200_bp.fa;sed -ie 's/>20881976 />20881976_mtDNA /g' AO245_newtrim_scaffolds_gt_200_bp.fa;sed -ie 's/>7036683 />7036683_mtDNA /g' AO245_newtrim_scaffolds_gt_200_bp.fa;sed -ie 's/>7546176 />7546176_mtDNA /g' AO245_newtrim_scaffolds_gt_200_bp.fa;sed -ie 's/>10549297 />10549297_mtDNA /g' AO245_newtrim_scaffolds_gt_200_bp.fa;sed -ie 's/>10549297 />10549297_mtDNA /g' AO245_newtrim_scaffolds_gt_200_bp.fa;sed -ie 's/>42704654 />42704654_mtDNA /g' AO245_newtrim_scaffolds_gt_200_bp.fa;sed -ie 's/>42174353 />42174353_mtDNA /g' AO245_newtrim_scaffolds_gt_200_bp.fa;sed -ie 's/>42280077 />42280077_mtDNA /g' AO245_newtrim_scaffolds_gt_200_bp.fa;sed -ie 's/>5981538 />5981538_mtDNA /g' AO245_newtrim_scaffolds_gt_200_bp.fa;sed -ie 's/>42346182 />42346182_mtDNA /g' AO245_newtrim_scaffolds_gt_200_bp.fa;sed -ie 's/>14017915 />14017915_mtDNA /g' AO245_newtrim_scaffolds_gt_200_bp.fa;sed -ie 's/>13047641 />13047641_mtDNA /g' AO245_newtrim_scaffolds_gt_200_bp.fa;sed -ie 's/>42622201 />42622201_mtDNA /g' AO245_newtrim_scaffolds_gt_200_bp.fa;sed -ie 's/>7376687 />7376687_mtDNA /g' AO245_newtrim_scaffolds_gt_200_bp.fa;sed -ie 's/>12284617 />12284617_mtDNA /g' AO245_newtrim_scaffolds_gt_200_bp.fa;sed -ie 's/>9247758 />9247758_mtDNA /g' AO245_newtrim_scaffolds_gt_200_bp.fa;sed -ie 's/>36124437 />36124437_mtDNA /g' AO245_newtrim_scaffolds_gt_200_bp.fa;sed -ie 's/>42370013 />42370013_mtDNA /g' AO245_newtrim_scaffolds_gt_200_bp.fa;sed -ie 's/>42146686 />42146686_mtDNA /g' AO245_newtrim_scaffolds_gt_200_bp.fa;sed -ie 's/>42227436 />42227436_mtDNA /g' AO245_newtrim_scaffolds_gt_200_bp.fa;sed -ie 's/>6881645 />6881645_mtDNA /g' AO245_newtrim_scaffolds_gt_200_bp.fa;sed -ie 's/>8165309 />8165309_mtDNA /g' AO245_newtrim_scaffolds_gt_200_bp.fa;sed -ie 's/>28738457 />28738457_mtDNA /g' AO245_newtrim_scaffolds_gt_200_bp.fa;sed -ie 's/>42141087 />42141087_mtDNA /g' AO245_newtrim_scaffolds_gt_200_bp.fa;sed -ie 's/>42033704 />42033704_mtDNA /g' AO245_newtrim_scaffolds_gt_200_bp.fa;sed -ie 's/>37192663 />37192663_mtDNA /g' AO245_newtrim_scaffolds_gt_200_bp.fa;sed -ie 's/>41547273 />41547273_mtDNA /g' AO245_newtrim_scaffolds_gt_200_bp.fa;sed -ie 's/>17235084 />17235084_mtDNA /g' AO245_newtrim_scaffolds_gt_200_bp.fa;sed -ie 's/>42614256 />42614256_mtDNA /g' AO245_newtrim_scaffolds_gt_200_bp.fa;sed -ie 's/>42568473 />42568473_mtDNA /g' AO245_newtrim_scaffolds_gt_200_bp.fa;sed -ie 's/>23842788 />23842788_mtDNA /g' AO245_newtrim_scaffolds_gt_200_bp.fa;sed -ie 's/>23337846 />23337846_mtDNA /g' AO245_newtrim_scaffolds_gt_200_bp.fa;sed -ie 's/>9277621 />9277621_mtDNA /g' AO245_newtrim_scaffolds_gt_200_bp.fa;sed -ie 's/>37377406 />37377406_mtDNA /g' AO245_newtrim_scaffolds_gt_200_bp.fa;sed -ie 's/>36290716 />36290716_mtDNA /g' AO245_newtrim_scaffolds_gt_200_bp.fa;sed -ie 's/>12535123 />12535123_mtDNA /g' AO245_newtrim_scaffolds_gt_200_bp.fa;sed -ie 's/>42642469 />42642469_mtDNA /g' AO245_newtrim_scaffolds_gt_200_bp.fa;sed -ie 's/>42467406 />42467406_mtDNA /g' AO245_newtrim_scaffolds_gt_200_bp.fa`



BELOW NOT USED
# finding the adapter in the assembly
/usr/local/blast/2.6.0/bin/blastn -query ../../AO245_WGS/abyss_genome_assembly/illumina_adaptor.fa -db AO248-scaffolds.fa_blastable -outfmt 6 -out illumina_adaptor_to_AO248WGS_assembly -evalue 1e-5 -max_target_seqs 1000000

/usr/local/blast/2.6.0/bin/blastn -query illumina_adaptor.fa -db AO245-scaffolds.fa_blastable -outfmt 6 -out illumina_adaptor_to_AO245WGS_assembly -evalue 1e-5 -max_target_seqs 1000000


# Masking 
A very small proportion of the assembly contained adaptors sequences, so these need to be masked in order to be able to submit them to NCBI:

bedtools maskfasta -fi AO248-scaffolds_greaterthan_200bp.fa -bed adapter.bed -fo AO248-scaffolds_greaterthan_200bp_masked.fa
