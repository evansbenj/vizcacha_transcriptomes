## Trimming and assembly

The data for Tympa and Octomys each were generated by multiplexing six RNA libraries (liver, heart, muscle, lung, kidney, and gonad (testis or ovary) on one lane.  This creates concerns about lane effects, which we will just have to include as a source of noise.

First we used Trimmomatic to trim the reads; both sets of transcriptomes were trimmed with trimmomatic version 0.32. For Tympa I ran each command line independently:

```
java -jar /work/ben/Trimmomatic-0.32/trimmomatic-0.32.jar PE -phred33 -trimlog Heart_log.txt Heart_R1.fastq.gz Heart_R2.fastq.gz Heart_R1_trim_paired.fastq.gz Heart_R1_trim_single.fastq.gz Heart_R2_trim_paired.fastq.gz Heart_R2_trim_single.fastq.gz ILLUMINACLIP:/work/ben/Trimmomatic-0.32/adapters/trimmomatic_adapters.fa:2:30:10 SLIDINGWINDOW:4:15 MINLEN:36
java -jar /work/ben/Trimmomatic-0.32/trimmomatic-0.32.jar PE -phred33 -trimlog Kidney_log.txt Kidney_R1.fastq.gz Kidney_R2.fastq.gz Kidney_R1_trim_paired.fastq.gz Kidney_R1_trim_single.fastq.gz Kidney_R2_trim_paired.fastq.gz Kidney_R2_trim_single.fastq.gz ILLUMINACLIP:/work/ben/Trimmomatic-0.32/adapters/trimmomatic_adapters.fa:2:30:10 SLIDINGWINDOW:4:15 MINLEN:36
java -jar /work/ben/Trimmomatic-0.32/trimmomatic-0.32.jar PE -phred33 -trimlog Liver_log.txt Liver_R1.fastq.gz Liver_R2.fastq.gz Liver_R1_trim_paired.fastq.gz Liver_R1_trim_single.fastq.gz Liver_R2_trim_paired.fastq.gz Liver_R2_trim_single.fastq.gz ILLUMINACLIP:/work/ben/Trimmomatic-0.32/adapters/trimmomatic_adapters.fa:2:30:10 SLIDINGWINDOW:4:15 MINLEN:36
java -jar /work/ben/Trimmomatic-0.32/trimmomatic-0.32.jar PE -phred33 -trimlog Lung_log.txt Lung_R1.fastq.gz Lung_R2.fastq.gz Lung_R1_trim_paired.fastq.gz Lung_R1_trim_single.fastq.gz Lung_R2_trim_paired.fastq.gz Lung_R2_trim_single.fastq.gz ILLUMINACLIP:/work/ben/Trimmomatic-0.32/adapters/trimmomatic_adapters.fa:2:30:10 SLIDINGWINDOW:4:15 MINLEN:36
java -jar /work/ben/Trimmomatic-0.32/trimmomatic-0.32.jar PE -phred33 -trimlog Muscle_log.txt Muscle_R1.fastq.gz Muscle_R2.fastq.gz Muscle_R1_trim_paired.fastq.gz Muscle_R1_trim_single.fastq.gz Muscle_R2_trim_paired.fastq.gz Muscle_R2_trim_single.fastq.gz ILLUMINACLIP:/work/ben/Trimmomatic-0.32/adapters/trimmomatic_adapters.fa:2:30:10 SLIDINGWINDOW:4:15 MINLEN:36
java -jar /work/ben/Trimmomatic-0.32/trimmomatic-0.32.jar PE -phred33 -trimlog Testis_log.txt Testis_R1.fastq.gz Testis_R2.fastq.gz Testis_R1_trim_paired.fastq.gz Testis_R1_trim_single.fastq.gz Testis_R2_trim_paired.fastq.gz Testis_R2_trim_single.fastq.gz ILLUMINACLIP:/work/ben/Trimmomatic-0.32/adapters/trimmomatic_adapters.fa:2:30:10 SLIDINGWINDOW:4:15 MINLEN:36
```
 For Octomys, I wrote a bash script:

``` bash
#!/bin/bash

files=”Heart
Liver
Lung
Muscle
Kidney
Ovary”

for file in $files
do
	java -jar /work/ben/Trimmomatic-0.32/trimmomatic-0.32.jar PE -phred33 -trimlog ${file}_log.txt AO248_${file}_R1.fastq.gz AO248_${file}_R2.fastq.gz AO248_${file}_R1_trim_paired.fastq.gz AO248_${file}_R1_trim_single.fastq.gz AO248_${file}_R2_trim_paired.fastq.gz AO248_${file}_R2_trim_single.fastq.gz ILLUMINACLIP:/work/ben/Trimmomatic-0.32/adapters/trimmomatic_adapters.fa:2:30:10 SLIDINGWINDOW:4:15 MINLEN:36
done
```

I am going to use Trinity version 2.1.1 for assembly.  I am using only reads where both pairs passed the trimming step and I am going to concatenate forward and reverse reads from all libraries for each species and do the assembly jointly for all libraries for each species. This should reduce redundancy, facilitate read mapping, and hopefully simplify things in general.

On info, here is the concatenation command for the forward reads for Octomys:

```
cat Heart/AO248_Heart_R1_trim_paired.fastq Kidney/AO248_Kidney_R1_trim_paired.fastq Liver/AO248_Liver_R1_trim_paired.fastq Lung/AO248_Lung_R1_trim_paired.fastq Muscle/AO248_Muscle_R1_trim_paired.fastq Ovary/AO248_Ovary_R1_trim_paired.fastq > AO248_all_R1_trim_paired.fastq
```

and for the reverse (R2) reads:

```
cat Heart/AO248_Heart_R2_trim_paired.fastq Kidney/AO248_Kidney_R2_trim_paired.fastq Liver/AO248_Liver_R2_trim_paired.fastq Lung/AO248_Lung_R2_trim_paired.fastq Muscle/AO248_Muscle_R2_trim_paired.fastq Ovary/AO248_Ovary_R2_trim_paired.fastq > AO248_all_R2_trim_paired.fastq
```
